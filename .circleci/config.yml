version: 2
jobs:
  deploy:
    docker:
      - image: google/cloud-sdk
    steps:
      - run:
          name: rajeshci
          command: echo $GCLOUD_SERVICE_KEY | base64 --decode --ignore-garbage > ${HOME}/gcloud-service-key.json
      - run: |
          # sudo gcloud auth activate-service-account --key-file=${HOME}/gcloud-service-key.json
          # sudo gcloud --quiet config set project ${GOOGLE_PROJECT_ID}
          # sudo gcloud --quiet config set compute/zone ${GOOGLE_COMPUTE_ZONE}
          # sudo gcloud --quiet container clusters get-credentials ${GOOGLE_CLUSTER_NAME}
          sudo /opt/google-cloud-sdk/bin/gcloud --quiet components update
          sudo /opt/google-cloud-sdk/bin/gcloud auth activate-service-account --key-file ${HOME}/gcloud-service-key.json
          sudo /opt/google-cloud-sdk/bin/gcloud config set project ${GOOGLE_PROJECT_ID}
          sudo /opt/google-cloud-sdk/bin/gcloud --quiet config set compute/zone ${GOOGLE_COMPUTE_ZONE}